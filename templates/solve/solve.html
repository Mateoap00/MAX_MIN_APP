{% extends 'maxMinApp/index.html' %}
{% block title %}Solución{% endblock %}
{% block content %}

{% if user.is_authenticated%}
{% load customFilters %}
<div class="mt-3 mb-3 col-6 col-md-12 mx-auto">
    <h2>Maximizar</h2>
    <h2>Función Objetivo:</h2>
    <h3>Zmax = {{ model.objFun }}</h3>
    <h2>Restricciones:</h2>
    <ol>
        {% for const in model.constraints %}
        <li>{{ const }}</li>
        {% endfor %}
    </ol>
    <h3>Tabla Inicial</h3>
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th scope="col">{{ firstTable.tableName }}</th>
                {% for colName in firstTable.colsNames %}
                <th scope="col">{{ colName }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody class="table-group-divider">
            {% for row in firstTable.table %}
            <tr>
                <th scope="row">{{ row }}</th>
                {% for value in firstTable.table|get_dict_value:row %}
                <td>{{ value }}</td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <h3>Método Simplex</h3>
    {% for tbl in allTables %}
    <h4>Tabla {{tbl.tableName}}</h4>
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th scope="col">{{ tbl.tableName }}</th>
                {% for colName in tbl.colsNames %}
                {% if forloop.counter0 == tbl.pivotCol.colNum%}
                <th scope="col" class="table-primary">{{ colName }}</th>
                {% else %}
                <th scope="col">{{ colName }}</th>
                {% endif%}
                {% endfor %}
            </tr>
        </thead>
        <tbody class="table-group-divider">
            {% for row in tbl.table %}
            {% if forloop.counter0 == tbl.pivotRow.rowNum%}
            <tr class="table-info">
                <th scope="row">{{ row }}</th>
                {% for value in tbl.table|get_dict_value:row %}
                {% if forloop.counter0 == tbl.pivotCol.colNum%}
                <td class="table-primary">{{ value }}</td>
                {% else %}
                <td>{{ value }}</td>
                {% endif%}
                {% endfor %}
            </tr>
            {% else %}
            <tr>
                <th scope="row">{{ row }}</th>
                {% for value in tbl.table|get_dict_value:row %}
                {% if forloop.counter0 == tbl.pivotCol.colNum%}
                <td class="table-primary">{{ value }}</td>
                {% else %}
                <td>{{ value }}</td>
                {% endif%}
                {% endfor %}
            </tr>
            {% endif%}
            {% endfor %}
        </tbody>
    </table>
    <ul>
        <li><strong>Columna pivote: </strong>{{tbl.pivotCol.colName}}</li>
        <li><strong>Fila pivote: </strong>{{tbl.pivotRow.rowName}}</li>
        <li><strong>Numero pivote: </strong>{{tbl.pivotValue}}</li>
        <li><strong>Fila entrante para siguiente tabla: </strong>{{tbl.enteringRow.rowName}} =
            {{tbl.enteringRow.entireRow}}</li>
    </ul>
    {% endfor %}

    <h3>Tabla Final</h3>
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th scope="col">{{ lastTable.tableName }}</th>
                {% for colName in lastTable.colsNames %}
                <th scope="col">{{ colName }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody class="table-group-divider">
            {% for row in lastTable.table %}
            <tr>
                <th scope="row">{{ row }}</th>
                {% for value in lastTable.table|get_dict_value:row %}
                <td>{{ value }}</td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h3>Solución:</h3>
    <ul>
        {% for sol in solution %}
        <li>
            <p>{{sol}} = {{solution|get_dict_value:sol}}</p>
        </li>
        {% endfor%}
    </ul>
</div>
{% endif %}

{% endblock %}